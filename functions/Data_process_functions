# Functions to edit and process the data during the analysis and visualization

## Merging restrictions (partials with not partials)
# Function to change value of selected restriction to 1, is the same restriction but as partial was applied
merge_partial_rest <- function(rest){
  part <- paste(rest, "Partial", sep = "")
  partial_rows <- which(dat[,which(colnames(dat) == part)] == 1)
  dat[partial_rows, which(colnames(dat) == rest)] <- 1
  return(dat[,which(colnames(dat) == rest)])
}

# Merge all restriction in the dataset
merge_all_partial_rest <- function(dat){
  part_vars <- colnames(dat)[grepl("Partial", colnames(dat))]
  
  #Pair of these restrictions
  part_pairs <- str_replace_all(part_vars, "Partial", "")
  
  dat <- as.data.frame(dat)
  
  dat[, part_pairs] <- do.call(cbind, lapply(part_pairs, function(x) merge_partial_rest(x)))
  dat <- dat[, -which(colnames(dat) %in% part_vars)]
  return(dat)
}
